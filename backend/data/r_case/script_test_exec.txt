import pandas as pd

revenue = pd.read_csv("apple-iphone-revenue.csv")
if (is.data.frame(revenue) | is.matrix(revenue)) {
        write(paste(append(colnames(revenue), 3, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(revenue, file="L3 (revenue).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(revenue)) {
            write(paste(append(group_vars(revenue), "group3", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
sales = pd.read_csv("apple-iphone-unit-sales.csv")
if (is.data.frame(sales) | is.matrix(sales)) {
        write(paste(append(colnames(sales), 4, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(sales, file="L4 (sales).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(sales)) {
            write(paste(append(group_vars(sales), "group4", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }

sales[['quarter', "year"]] = sales.Category.str.split("/",expand=True)
revenue[['quarter', "year"]] = revenue.Category.str.split("/",expand=True)

s_sum = sales.groupby(['year']).sum()
if (is.data.frame(s_sum) | is.matrix(s_sum)) {
        write(paste(append(colnames(s_sum), 9, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(s_sum, file="L9 (s_sum).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(s_sum)) {
            write(paste(append(group_vars(s_sum), "group9", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
r_sum = revenue.groupby(['year']).sum()
if (is.data.frame(r_sum) | is.matrix(r_sum)) {
        write(paste(append(colnames(r_sum), 10, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(r_sum, file="L10 (r_sum).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(r_sum)) {
            write(paste(append(group_vars(r_sum), "group10", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }

s_sum = s_sum.reset_index(drop=True)
if (is.data.frame(s_sum) | is.matrix(s_sum)) {
        write(paste(append(colnames(s_sum), 12, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(s_sum, file="L12 (s_sum).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(s_sum)) {
            write(paste(append(group_vars(s_sum), "group12", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
r_sum = r_sum.reset_index(drop=True)
if (is.data.frame(r_sum) | is.matrix(r_sum)) {
        write(paste(append(colnames(r_sum), 13, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(r_sum, file="L13 (r_sum).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(r_sum)) {
            write(paste(append(group_vars(r_sum), "group13", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }

# rev_sales2 = pd.merge([s_sum, r_sum])
rev_sales = pd.concat([s_sum, r_sum])
if (is.data.frame(rev_sales) | is.matrix(rev_sales)) {
        write(paste(append(colnames(rev_sales), 16, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(rev_sales, file="L16 (rev_sales).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(rev_sales)) {
            write(paste(append(group_vars(rev_sales), "group16", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
rev_sales.loc[len(rev_sales)] = rev_sales.mean()
