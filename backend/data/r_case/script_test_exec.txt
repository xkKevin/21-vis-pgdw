library(dplyr)

warpbreaks = read.csv("warpbreaks.csv")
if (is.data.frame(warpbreaks) | is.matrix(warpbreaks)) {
        write(paste(append(colnames(warpbreaks), 3, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(warpbreaks, file="L3 (warpbreaks).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(warpbreaks)) {
            write(paste(append(group_vars(warpbreaks), "group3", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
warpbreaks = unique(warpbreaks)
if (is.data.frame(warpbreaks) | is.matrix(warpbreaks)) {
        write(paste(append(colnames(warpbreaks), 4, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(warpbreaks, file="L4 (warpbreaks).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(warpbreaks)) {
            write(paste(append(group_vars(warpbreaks), "group4", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_tens = rename(warpbreaks, tens=tension)
if (is.data.frame(wb_tens) | is.matrix(wb_tens)) {
        write(paste(append(colnames(wb_tens), 5, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_tens, file="L5 (wb_tens).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_tens)) {
            write(paste(append(group_vars(wb_tens), "group5", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_tens = group_by(wb_tens, tens)
if (is.data.frame(wb_tens) | is.matrix(wb_tens)) {
        write(paste(append(colnames(wb_tens), 6, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_tens, file="L6 (wb_tens).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_tens)) {
            write(paste(append(group_vars(wb_tens), "group6", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_tens = mutate(wb_tens, count = n())
if (is.data.frame(wb_tens) | is.matrix(wb_tens)) {
        write(paste(append(colnames(wb_tens), 7, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_tens, file="L7 (wb_tens).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_tens)) {
            write(paste(append(group_vars(wb_tens), "group7", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_tens = ungroup(wb_tens)
if (is.data.frame(wb_tens) | is.matrix(wb_tens)) {
        write(paste(append(colnames(wb_tens), 8, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_tens, file="L8 (wb_tens).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_tens)) {
            write(paste(append(group_vars(wb_tens), "group8", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_tens_r = mutate(wb_tens, rate=breaks/count)
if (is.data.frame(wb_tens_r) | is.matrix(wb_tens_r)) {
        write(paste(append(colnames(wb_tens_r), 9, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_tens_r, file="L9 (wb_tens_r).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_tens_r)) {
            write(paste(append(group_vars(wb_tens_r), "group9", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_l = rbind(warpbreaks, list(70, 'A', 'L'))
if (is.data.frame(wb_l) | is.matrix(wb_l)) {
        write(paste(append(colnames(wb_l), 10, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_l, file="L10 (wb_l).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_l)) {
            write(paste(append(group_vars(wb_l), "group10", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
wb_sort = arrange(wb_l, -breaks)
if (is.data.frame(wb_sort) | is.matrix(wb_sort)) {
        write(paste(append(colnames(wb_sort), 11, after = 0), collapse=','), "colnames.txt", append=T)
        write.table(wb_sort, file="L11 (wb_sort).csv", sep=",", quote=FALSE, append=FALSE, na="NA", row.names=FALSE)
        if (is.grouped_df(wb_sort)) {
            write(paste(append(group_vars(wb_sort), "group11", after = 0), collapse=','), "colnames.txt", append=T)
        }
    }
